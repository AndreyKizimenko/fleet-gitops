agent_options:
  config:
    decorators:
      load:
      - SELECT uuid AS host_uuid FROM system_info;
      - SELECT hostname AS hostname FROM system_info;
    options:
      disable_distributed: false
      distributed_interval: 10
      distributed_plugin: tls
      distributed_tls_max_attempts: 3
      logger_tls_endpoint: /api/osquery/log
      logger_tls_period: 10
      pack_delimiter: /
  overrides:
controls:
  enable_disk_encryption: true
  ios_updates:
    deadline:
    minimum_version:
  ipados_updates:
    deadline:
    minimum_version:
  macos_updates:
    deadline:
    minimum_version:
  scripts:
  windows_enabled_and_configured: true
  windows_require_bitlocker_pin: true
  windows_updates:
    deadline_days:
    grace_period_days:
name: Windows Pin
policies:
queries:
- automations_enabled: false
  description:
  discard_data: false
  interval: 3600
  logging: snapshot
  min_osquery_version:
  name: "1"
  observer_can_run: false
  platform: windows
  query: "WITH should_run(yes) AS (\n\t\t\tSELECT\n\t\t\t\t(\n\t\t\t\t\t-- BitLocker
    is an optional feature but enabled\n\t\t\t\t\tEXISTS(SELECT 1 FROM windows_optional_features
    WHERE name = 'BitLocker' AND state = 1)\n\t\t\t\t\t-- BitLocker is built in, so
    it won't appear as an optional feature\n\t\t\t\t\tOR NOT EXISTS(SELECT 1 FROM
    windows_optional_features WHERE name = 'BitLocker') \n\t\t\t\t)\n\t\t\t\t-- PIN
    is already set, so regardless of the current config, we don't need to enforce
    it:\n\t\t\t\t-- 4: TPM And PIN.\n\t\t\t\t-- 6: TPM And PIN And Startup key.\n\t\t\t\tAND
    NOT EXISTS(SELECT 1 FROM bitlocker_key_protectors WHERE drive_letter = 'C:' AND
    key_protector_type IN (4,6))\n\t\t\t\t-- Volume is encrypted\n\t\t\t\tAND EXISTS(SELECT
    1 FROM bitlocker_info WHERE drive_letter = 'C:' AND protection_status = 1)\n\t\t\t)\n\t\t\tSELECT
    1 FROM should_run WHERE yes = 1"
- automations_enabled: false
  description:
  discard_data: false
  interval: 3600
  logging: snapshot
  min_osquery_version:
  name: "2"
  observer_can_run: false
  platform: windows
  query: SELECT data FROM registry WHERE path='HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPMPIN'
software:
team_settings:
  features:
    enable_host_users: true
    enable_software_inventory: true
  host_expiry_settings:
    host_expiry_enabled: false
    host_expiry_window: 0
  integrations:
    conditional_access_enabled:
    google_calendar:
  secrets:
  - secret: $FLEET_WINDOWS_PIN_ENROLL_SECRET # TODO: Add your enroll secrets here
  webhook_settings:
    failing_policies_webhook:
      destination_url:
      enable_failing_policies_webhook: false
      host_batch_size: 0
      policy_ids:
    host_status_webhook: